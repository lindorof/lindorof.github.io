<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>网络编程概念汇总 | Lindorof</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <meta name="description" content="Lindorof's Blog">
    <link rel="preload" href="/assets/css/0.styles.8ac2847d.css" as="style"><link rel="preload" href="/assets/js/app.b639eb72.js" as="script"><link rel="preload" href="/assets/js/2.5df156af.js" as="script"><link rel="preload" href="/assets/js/96.306bee11.js" as="script"><link rel="prefetch" href="/assets/js/10.ee4568ff.js"><link rel="prefetch" href="/assets/js/11.8db0767a.js"><link rel="prefetch" href="/assets/js/12.92a4e660.js"><link rel="prefetch" href="/assets/js/13.e2450b62.js"><link rel="prefetch" href="/assets/js/14.5ae14743.js"><link rel="prefetch" href="/assets/js/15.62a967cf.js"><link rel="prefetch" href="/assets/js/16.3482df63.js"><link rel="prefetch" href="/assets/js/17.881a9d91.js"><link rel="prefetch" href="/assets/js/18.d6e19ee5.js"><link rel="prefetch" href="/assets/js/19.caf0829a.js"><link rel="prefetch" href="/assets/js/20.a80e123c.js"><link rel="prefetch" href="/assets/js/21.9c810086.js"><link rel="prefetch" href="/assets/js/22.bc5f69cb.js"><link rel="prefetch" href="/assets/js/23.f15ef55d.js"><link rel="prefetch" href="/assets/js/24.b8714e3e.js"><link rel="prefetch" href="/assets/js/25.d673c092.js"><link rel="prefetch" href="/assets/js/26.28d57b84.js"><link rel="prefetch" href="/assets/js/27.d8b15b76.js"><link rel="prefetch" href="/assets/js/28.2574be13.js"><link rel="prefetch" href="/assets/js/29.54667d47.js"><link rel="prefetch" href="/assets/js/3.f6602695.js"><link rel="prefetch" href="/assets/js/30.dd697263.js"><link rel="prefetch" href="/assets/js/31.aafbc8db.js"><link rel="prefetch" href="/assets/js/32.5fe2531d.js"><link rel="prefetch" href="/assets/js/33.c3dfca3c.js"><link rel="prefetch" href="/assets/js/34.22613e38.js"><link rel="prefetch" href="/assets/js/35.aad9af2b.js"><link rel="prefetch" href="/assets/js/36.badbd522.js"><link rel="prefetch" href="/assets/js/37.45905373.js"><link rel="prefetch" href="/assets/js/38.ab0de43e.js"><link rel="prefetch" href="/assets/js/39.d1a7492c.js"><link rel="prefetch" href="/assets/js/4.c7710dca.js"><link rel="prefetch" href="/assets/js/40.92c4cb14.js"><link rel="prefetch" href="/assets/js/41.cc19be50.js"><link rel="prefetch" href="/assets/js/42.c9b4b585.js"><link rel="prefetch" href="/assets/js/43.1af966c8.js"><link rel="prefetch" href="/assets/js/44.40ebac1c.js"><link rel="prefetch" href="/assets/js/45.469b8553.js"><link rel="prefetch" href="/assets/js/46.eb491d21.js"><link rel="prefetch" href="/assets/js/47.03d1fbf2.js"><link rel="prefetch" href="/assets/js/48.af296c16.js"><link rel="prefetch" href="/assets/js/49.3a42b55b.js"><link rel="prefetch" href="/assets/js/5.339eb2f5.js"><link rel="prefetch" href="/assets/js/50.ef35a161.js"><link rel="prefetch" href="/assets/js/51.284d50de.js"><link rel="prefetch" href="/assets/js/52.c4983004.js"><link rel="prefetch" href="/assets/js/53.83c193e1.js"><link rel="prefetch" href="/assets/js/54.08f26cd6.js"><link rel="prefetch" href="/assets/js/55.ef20313b.js"><link rel="prefetch" href="/assets/js/56.dc2772cf.js"><link rel="prefetch" href="/assets/js/57.add26447.js"><link rel="prefetch" href="/assets/js/58.ff8f2704.js"><link rel="prefetch" href="/assets/js/59.43fdbc04.js"><link rel="prefetch" href="/assets/js/6.0ce72a94.js"><link rel="prefetch" href="/assets/js/60.1a27c7c3.js"><link rel="prefetch" href="/assets/js/61.9ca63ff6.js"><link rel="prefetch" href="/assets/js/62.9ab09b12.js"><link rel="prefetch" href="/assets/js/63.a6b6d595.js"><link rel="prefetch" href="/assets/js/64.5e9ac56b.js"><link rel="prefetch" href="/assets/js/65.bcfb6015.js"><link rel="prefetch" href="/assets/js/66.5024eb22.js"><link rel="prefetch" href="/assets/js/67.5d83f99f.js"><link rel="prefetch" href="/assets/js/68.80f05874.js"><link rel="prefetch" href="/assets/js/69.6f9ff293.js"><link rel="prefetch" href="/assets/js/7.726c7fbf.js"><link rel="prefetch" href="/assets/js/70.92b749fb.js"><link rel="prefetch" href="/assets/js/71.a4248217.js"><link rel="prefetch" href="/assets/js/72.29aeb940.js"><link rel="prefetch" href="/assets/js/73.8918e90b.js"><link rel="prefetch" href="/assets/js/74.81fd32da.js"><link rel="prefetch" href="/assets/js/75.5357ccc2.js"><link rel="prefetch" href="/assets/js/76.66fc1725.js"><link rel="prefetch" href="/assets/js/77.6f29512b.js"><link rel="prefetch" href="/assets/js/78.a63871cd.js"><link rel="prefetch" href="/assets/js/79.c646997c.js"><link rel="prefetch" href="/assets/js/8.81d630fc.js"><link rel="prefetch" href="/assets/js/80.b5d5ad39.js"><link rel="prefetch" href="/assets/js/81.601aa569.js"><link rel="prefetch" href="/assets/js/82.99bc0640.js"><link rel="prefetch" href="/assets/js/83.06d4defc.js"><link rel="prefetch" href="/assets/js/84.44856307.js"><link rel="prefetch" href="/assets/js/85.3b88ee80.js"><link rel="prefetch" href="/assets/js/86.47c806cb.js"><link rel="prefetch" href="/assets/js/87.b5201cdf.js"><link rel="prefetch" href="/assets/js/88.f9ce8655.js"><link rel="prefetch" href="/assets/js/89.c1f12bf1.js"><link rel="prefetch" href="/assets/js/9.b6118830.js"><link rel="prefetch" href="/assets/js/90.e0f850a2.js"><link rel="prefetch" href="/assets/js/91.8166ca11.js"><link rel="prefetch" href="/assets/js/92.6ba6ce27.js"><link rel="prefetch" href="/assets/js/93.6e09fb58.js"><link rel="prefetch" href="/assets/js/94.1b324565.js"><link rel="prefetch" href="/assets/js/95.5308659f.js"><link rel="prefetch" href="/assets/js/97.6e231fca.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8ac2847d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpg" alt="Lindorof" class="logo"> <span class="site-name can-hide">Lindorof</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/archives.html" class="nav-link">
  文章清单
</a></div><div class="nav-item"><a href="/guide.html" class="nav-link">
  建站指南
</a></div><div class="nav-item"><a href="https://github.com/lindorof" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/archives.html" class="nav-link">
  文章清单
</a></div><div class="nav-item"><a href="/guide.html" class="nav-link">
  建站指南
</a></div><div class="nav-item"><a href="https://github.com/lindorof" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>网络编程概念汇总</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#阻塞-非阻塞-io多路复用-异步" class="sidebar-link">阻塞/非阻塞/IO多路复用/异步</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#基础" class="sidebar-link">基础</a></li><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#阻塞" class="sidebar-link">阻塞</a></li><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#非阻塞" class="sidebar-link">非阻塞</a></li><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#io多路复用" class="sidebar-link">IO多路复用</a></li><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#异步" class="sidebar-link">异步</a></li><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#select-poll-epoll" class="sidebar-link">select/poll/epoll</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#select" class="sidebar-link">select</a></li><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#poll" class="sidebar-link">poll</a></li><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#epoll" class="sidebar-link">epoll</a></li><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#总结-2" class="sidebar-link">总结</a></li></ul></li><li><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#reactor-proactor" class="sidebar-link">Reactor/Proactor</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#reactor" class="sidebar-link">Reactor</a></li><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#proactor" class="sidebar-link">Proactor</a></li><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#总结-3" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E6%A6%82%E5%BF%B5%E6%B1%87%E6%80%BB.html#再次总结" class="sidebar-link">再次总结</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="网络编程概念汇总"><a href="#网络编程概念汇总" class="header-anchor">#</a> 网络编程概念汇总</h1> <p><em>根据学习网络上大量的碎片知识，进行汇总和梳理。</em></p> <h2 id="阻塞-非阻塞-io多路复用-异步"><a href="#阻塞-非阻塞-io多路复用-异步" class="header-anchor">#</a> 阻塞/非阻塞/IO多路复用/异步</h2> <h3 id="基础"><a href="#基础" class="header-anchor">#</a> 基础</h3> <p>它们并不是独立存在的多种网络I/O，只是描述的方式不同而已。首先明确基础概念：</p> <ol><li><p>进行网络I/O时，例如读、写，存在两个基本动作：</p> <ul><li>判断是否就绪，例如当前是否有数据到达，从而可读；</li> <li>数据就绪后，将数据读出，进行后续处理；</li></ul></li> <li><p>网络I/O操作在操作系统中存在两个层面的切换：</p> <ul><li>内核层，进行I/O状态判断，数据读写等；</li> <li>用户层，对内核层进行状态判断、数据读写的请求操作等；</li></ul></li></ol> <h3 id="阻塞"><a href="#阻塞" class="header-anchor">#</a> 阻塞</h3> <ol><li>发起IO请求，开始阻塞；</li> <li>等待内核层状态就绪；</li> <li>状态就绪后拷贝数据到用户层；</li> <li>阻塞结束；</li></ol> <h3 id="非阻塞"><a href="#非阻塞" class="header-anchor">#</a> 非阻塞</h3> <ol><li>发起IO请求，立即返回；</li> <li>不断的主动询问内核层状态是否就绪；</li> <li>若状态就绪，拷贝数据到用户层；</li></ol> <h3 id="io多路复用"><a href="#io多路复用" class="header-anchor">#</a> IO多路复用</h3> <ol><li>针对非阻塞的方式进行改进，因为非阻塞方式需要主动的不断询问内核层状态，当fd较多时不便于处理；</li> <li>将要处理的多个fd交给内核层，内核层同时查看多个fd是否有就绪的，而用户层阻塞；</li> <li>若有就绪的fd则结束阻塞，用户层针对就绪的fd进行处理；</li></ol> <h3 id="异步"><a href="#异步" class="header-anchor">#</a> 异步</h3> <ol><li>用户层发起IO请求，立即返回；</li> <li>内核层自行等待状态就绪并处理数据例如拷贝；</li> <li>结束后发起回调，告知用户层；</li></ol> <h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <ol><li>看似术语很多，其实只有三种：阻塞，非阻塞，异步；</li> <li>IO多路复用只是针对非阻塞的改进方式，例如select,poll,epoll；其中epoll是linux提供的方式；</li> <li>异步只有Windows的IOCP做了很好的实现；</li> <li>所谓的同步和异步，就看如何理解:
<ul><li>可以认为阻塞、非阻塞、IO多路复用都是同步，因为同步过程要不是等待内核层数据就绪（例如阻塞），要不就是从内核层同步的拷贝数据（例如非阻塞）；</li> <li>也可以认为只有阻塞式是同步，其它的都是异步；</li> <li>也可以认为只有Windows的IOCP才是异步，其它的都是同步；</li></ul></li></ol> <h2 id="select-poll-epoll"><a href="#select-poll-epoll" class="header-anchor">#</a> select/poll/epoll</h2> <p>都是IO多路复用的方式，只有Windows的IOCP是真正的异步IO，因此详细说明几种IO多路复用的区别。</p> <h3 id="select"><a href="#select" class="header-anchor">#</a> select</h3> <ol><li>使用数组存储fd，个数有限制，32位系统是1024个，64位系统是2048个；</li> <li>每次进行select时，将fd全部拷贝进内核层；</li> <li>内核层将所有的fd遍历一遍，针对就绪的fd，设置对应就绪标记，例如读，写，错误等；</li> <li>若都没有任何fd就绪，则阻塞并睡眠一段时间后继续轮询；</li> <li>有任何fd就绪，则返回；</li> <li>所以轮询fd的时间复杂度是O(n)；</li></ol> <h3 id="poll"><a href="#poll" class="header-anchor">#</a> poll</h3> <ol><li>使用链表存储fd，因此个数没有限制；</li> <li>其它方面和原理包括时间复杂度都与select完全相同；</li></ol> <h3 id="epoll"><a href="#epoll" class="header-anchor">#</a> epoll</h3> <ol><li>epoll的意思就是event poll，是对poll的改进；</li> <li>不用重复拷贝全部fd进内核层，而是在有新的fd时，挂接进内核层；</li> <li>因此fd的存储空间是内核层和用户层共享的一片内存；</li> <li>对于fd的个数也没有限制；</li> <li>内核层会为每个fd指定一个回调，在该fd就绪时，回调被触发，然后把fd放到一个就绪链表中；</li> <li>从而epoll的时候，内核层不是在轮询所有fd，而是只轮询就绪链表；</li> <li>因此针对就绪fd的查询上，时间复杂度为O(1)；因为某个fd就绪时会自动被加入到就绪链表中，从而epoll立即检测到有就绪的fd；</li> <li>但是，如果活跃的fd很多，那么就绪链表也会增大，从而影响性能，因此针对这个问题，epoll提供LT和ET，即水平触发和边缘触发两种方式；</li> <li>水平触发的意思是，只要就绪的fd未被处理，则会重复触发，所以如果就绪链表增大，那么性能也会收到影响；</li> <li>边缘触发的意思是，就绪的fd只会被触发一次，直到第二次就绪状态到达，从而用户层可以只处理自己关心的fd；</li></ol> <h3 id="总结-2"><a href="#总结-2" class="header-anchor">#</a> 总结</h3> <ol><li>关于fd在内核层与用户层之间的重复拷贝和挂接：selecet和poll每次调用时都需要重复拷贝和挂接fd，但epoll针对每个fd只需要拷贝和挂接一次；</li> <li>关于fd在内核层与用户层之间的内存关系：select和poll每次调用时都需要将用户层的fd内存拷贝到内核层的fd内存，而epoll则在内核层和用户层之间共享fd内存，用户层只需要将新的fd挂接到该共享的内存中；</li> <li>关于fd的轮询方式：select和poll轮询的是所有的fd，时间复杂度是O(n)，epoll中由fd就绪时会自动触发回调进而被加入就绪链表，因此时间复杂度是O(1)，所以epoll轮询的是就绪的fd而不是全部fd；</li> <li>关于fd的存储方式：select使用数组，大小有限制，32位系统是1024，64位系统是2048；poll和epoll都使用链表的方式，大小理论上没有限制；</li></ol> <h2 id="reactor-proactor"><a href="#reactor-proactor" class="header-anchor">#</a> Reactor/Proactor</h2> <h3 id="reactor"><a href="#reactor" class="header-anchor">#</a> Reactor</h3> <ol><li>也叫反应器；</li> <li>大致思路是，用户为fd注册所关心的事件，例如可读事件，可写事件；</li> <li>然后Reactor进行事件轮询，有任何fd的任何事件发生时，就调用用户所设置的对应的处理方法；</li> <li>用户的处理方法开始进行读、写等操作；</li></ol> <h3 id="proactor"><a href="#proactor" class="header-anchor">#</a> Proactor</h3> <ol><li>也叫前摄式，或者主动器；</li> <li>大致思路是，用户为fd发起对应的操作，例如读操作，或者写操作；</li> <li>每个操作都是异步的，对应的每个操作都有一个完成后的回调；</li> <li>然后Proactor管理完成事件队列，并分发这些完成事件，也就是调用用户的回调；</li></ol> <h3 id="总结-3"><a href="#总结-3" class="header-anchor">#</a> 总结</h3> <ol><li>被动和主动：Reactor是被动的，在状态就绪时进行对应的操作；Proactor是主动的，主动发起操作，在就绪并操作完成后，处理最终的完成回调；</li> <li>串行和并发：Reactor在一个反应器内，所有操作都是串行的，例如一个Reactor内监听了多个fd的多个事件，则所有fd的所有事件都是串行也就是同步的响应的；Proactor则可以异步也就是并发的发起多个fd的多个操作，然后每个fd的每个操作完成事件都单独响应；</li> <li>简单和复杂：Reactor的事件处理可以理解为单线程顺序执行的，不用考虑并发加锁等问题，Proactor由于响应是异步的，处理要相对复杂一些；</li> <li>时间和性能：Reactor的在事件响应操作时不能耗时太长，否则会影响其它fd和事件的响应，Proactor由于是异步的，可以处理耗时较长的任务；</li></ol> <h3 id="再次总结"><a href="#再次总结" class="header-anchor">#</a> 再次总结</h3> <ol><li>Reactor和Proactor只是一种IO设计模式，注意是软件设计模式，与操作系统提供的IO处理方式是没有直接联系的；</li> <li>例如，libevent框架、libuv框架，使用Reactor模式，使用了操作系统的select/poll机制，在linux下也使用了epoll，而在windows下，也有针对iocp的实现；</li> <li>例如，ACE框架，提供了Reactor模式，也提供了Proactor模式；</li> <li>例如，ASIO框架，使用Proactor模式，但在linux下使用epoll来包装，而windows下则使用IOCP；</li> <li>所以，针对不同的操作系统提供的IO机制，都可以进行Reactor或者Proactor模式的设计，比如ACE，使用Reactor或者Proactor模式的时候，不用关心ACE内部是如何实现的，而ACE可以利用不同的操作系统下最优的IO机制；</li> <li>前述总结的Reactor或者Proactor的优缺点和不同，并不是绝对的，比如，“Reactor的在事件响应操作时不能耗时太长，否则会影响其它fd和事件的响应”，实际场景中可能在读事件到达后，进行数据读取，然后放入另一个逻辑线程中进行后续处理；</li> <li>所以，两种设计模式的采用是需要根据实际场景，进行复杂度和性能的综合权衡；</li> <li>同理，要直接调用系统提供的IO机制的API，例如select/poll/epoll/iocp，还是要采用一些网络框架，例如libevent，libuv，ACE，也取决于复杂度、性能、场景的考量；</li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">4/7/2020, 8:06:26 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.b639eb72.js" defer></script><script src="/assets/js/2.5df156af.js" defer></script><script src="/assets/js/96.306bee11.js" defer></script>
  </body>
</html>
