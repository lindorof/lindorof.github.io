(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{504:function(t,s,a){"use strict";a.r(s);var n=a(27),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_15-3-使用-drop-清理资源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-3-使用-drop-清理资源"}},[t._v("#")]),t._v(" 15.3. 使用 "),a("code",[t._v("Drop")]),t._v(" 清理资源")]),t._v(" "),a("h3",{attrs:{id:"关于-drop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于-drop"}},[t._v("#")]),t._v(" 关于 "),a("code",[t._v("Drop")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Drop")]),t._v(" 是一种重要的 trait ，对应需要实现的方法是 "),a("code",[t._v("drop")])]),t._v(" "),a("li",[t._v("它的作用是，在某个值要被清理时，通过该 trait 来执行一些清理工作")]),t._v(" "),a("li",[t._v("例如，这个清理工作可能是释放文件或网络连接的资源")]),t._v(" "),a("li",[t._v("在 rust 中，"),a("code",[t._v("Drop")]),t._v(" 就是理解为对象的"),a("strong",[t._v("析构器")]),t._v("（"),a("em",[a("strong",[t._v("destructor")])]),t._v("）")])]),t._v(" "),a("h3",{attrs:{id:"使用范围"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用范围"}},[t._v("#")]),t._v(" 使用范围")]),t._v(" "),a("ul",[a("li",[t._v("任何类型都可以实现 "),a("code",[t._v("Drop")])]),t._v(" "),a("li",[t._v("而使用最多的就是智能指针")]),t._v(" "),a("li",[t._v("例如，"),a("code",[t._v("Box<T>")]),t._v(" 实现了 "),a("code",[t._v("Drop")]),t._v(" ，用来释放 box 所指向的堆空间")])]),t._v(" "),a("h3",{attrs:{id:"运行规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行规则"}},[t._v("#")]),t._v(" 运行规则")]),t._v(" "),a("ul",[a("li",[t._v("假设要被释放的值是 "),a("code",[t._v("obj")])]),t._v(" "),a("li",[t._v("那么， "),a("code",[t._v("obj")]),t._v(" 被释放的时机是离开对应的作用域时")]),t._v(" "),a("li",[t._v("也就是说，rust 系统来决定何时释放，而所决定的规则就是变量离开作用域时")]),t._v(" "),a("li",[t._v("程序员也可以要求提前清理，后续会讲解")])]),t._v(" "),a("h3",{attrs:{id:"清理的内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#清理的内容"}},[t._v("#")]),t._v(" 清理的内容")]),t._v(" "),a("ol",[a("li",[t._v("假设要被释放的值是 "),a("code",[t._v("obj")])]),t._v(" "),a("li",[t._v("那么，首先 "),a("code",[t._v("obj")]),t._v(" 本身的内存是被 rust 自动释放的")]),t._v(" "),a("li",[t._v("其次， "),a("code",[t._v("obj")]),t._v(" 可能关联了其它的一些资源，这些其它的资源释放就是通过 "),a("code",[t._v("obj")]),t._v(" 的 "),a("code",[t._v("Drop")]),t._v(" 来完成，与 rust 无关")])]),t._v(" "),a("h3",{attrs:{id:"提前清理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#提前清理"}},[t._v("#")]),t._v(" 提前清理")]),t._v(" "),a("ol",[a("li",[t._v("rust 不允许手动调用 "),a("code",[t._v("Drop")]),t._v(" 这个 trait")]),t._v(" "),a("li",[t._v("原因是：即使手动调用了该 trait ，但 rust 是不知道的，在变量离开作用域时，rust 系统依然会自动触发该 trait ，导致了双重清理，即 "),a("strong",[t._v("double free")]),t._v(" ，所以手动调用该 trait 是不允许的")]),t._v(" "),a("li",[t._v("而要解决该问题，办法很简单，就是触发 "),a("code",[t._v("Drop")]),t._v(" 这个 trait 的时候，要让 rust 系统知道")]),t._v(" "),a("li",[t._v("因此，解决办法就是：不要使用变量的 "),a("code",[t._v("Drop")]),t._v(" ，而是使用 rust 系统中提供的 "),a("code",[t._v("drop")]),t._v(" 方法")]),t._v(" "),a("li",[t._v("rust 提供的 "),a("code",[t._v("drop")]),t._v(" 方法的本质，就是去调用变量的 "),a("code",[t._v("Drop")]),t._v(" ，但区别是：该方法是 rust 系统实现的，所以 rust 会自己做标记，表示该变量已经被清理了，后续不需要再清理了")])]),t._v(" "),a("h3",{attrs:{id:"举例：实现-drop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#举例：实现-drop"}},[t._v("#")]),t._v(" 举例：实现 "),a("code",[t._v("Drop")])]),t._v(" "),a("blockquote",[a("p",[t._v("例子只是为了讲述 "),a("code",[t._v("Drop")]),t._v(" 的实现，而不关注所释放的资源，因此就将 "),a("code",[t._v("Drop")]),t._v(" 实现为简单的信息打印")])]),t._v(" "),a("p",[t._v("有 struct 如下：")]),t._v(" "),a("div",{staticClass:"language-rust line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-rust"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" CustomSmartPointer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("实现 "),a("code",[t._v("Drop")]),t._v(" ：")]),t._v(" "),a("div",{staticClass:"language-rust line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-rust"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("impl")]),t._v(" Drop "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" CustomSmartPointer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fn")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mut")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("self")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CustomSmartPointer-Drop-Trait ({})"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("self")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[t._v("注意：")]),t._v(" "),a("ul",[a("li",[t._v("参数是 "),a("code",[t._v("&mut self")])]),t._v(" "),a("li",[t._v("因为清理资源涉及到内容的变化，所以必须 "),a("code",[t._v("&mut")])])]),t._v(" "),a("p",[t._v("测试：")]),t._v(" "),a("div",{staticClass:"language-rust line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-rust"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fn")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" c1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CustomSmartPointer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"first"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" c2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CustomSmartPointer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"second"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CustomSmartPointers created"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[t._v("打印结果：")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("CustomSmartPointers created\nCustomSmartPointer-Drop-Trait "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("second"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nCustomSmartPointer-Drop-Trait "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("first"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("剖析：")]),t._v(" "),a("ol",[a("li",[t._v("创建了两个实例，创建完成后打印 "),a("code",[t._v("CustomSmartPointers created")])]),t._v(" "),a("li",[t._v("接着两个实例离开了作用域，rust 系统开始清理，可以看到清理时 rust 调用了 "),a("code",[t._v("Drop")])]),t._v(" "),a("li",[t._v("可以看到："),a("strong",[t._v("清理的顺序与创建的顺序相反")])])]),t._v(" "),a("h3",{attrs:{id:"举例：提前清理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#举例：提前清理"}},[t._v("#")]),t._v(" 举例：提前清理")]),t._v(" "),a("blockquote",[a("p",[t._v("继续使用上面的例子")])]),t._v(" "),a("p",[t._v("手动调用 "),a("code",[t._v("Drop")]),t._v(" ：")]),t._v(" "),a("div",{staticClass:"language-rust line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-rust"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fn")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" c1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CustomSmartPointer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"first"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CustomSmartPointers created"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    c1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[t._v("编译错误：")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("E0040"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": explicit use of destructor method\nc1.drop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   ^^^^ explicit destructor calls not allowed\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("调用 rust 系统的 "),a("code",[t._v("drop")]),t._v(" ：")]),t._v(" "),a("div",{staticClass:"language-rust line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-rust"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fn")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" c1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CustomSmartPointer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"first"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CustomSmartPointers created"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("drop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"end of main"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("p",[t._v("运行结果：")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("CustomSmartPointers created\nCustomSmartPointer-Drop-Trait "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("first"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nCustomSmartPointer dropped before the end of main\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("剖析：")]),t._v(" "),a("ol",[a("li",[t._v("在离开作用域之前，手动调用 rust 系统的 "),a("code",[t._v("drop")]),t._v(" 完成了释放")]),t._v(" "),a("li",[t._v("rust 系统的 "),a("code",[t._v("drop")]),t._v(" 本质是调用实例的 "),a("code",[t._v("Drop")])]),t._v(" "),a("li",[t._v("离开作用域之后，可以看到 rust 没有再次触发 "),a("code",[t._v("Drop")]),t._v(" ，因为 rust 知道该变量已经被释放过了")])])])}),[],!1,null,null,null);s.default=r.exports}}]);