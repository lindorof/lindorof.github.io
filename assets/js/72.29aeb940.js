(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{510:function(e,s,a){"use strict";a.r(s);var t=a(27),r=Object(t.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"_14-1-自定义-build"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_14-1-自定义-build"}},[e._v("#")]),e._v(" 14.1. 自定义 Build")]),e._v(" "),a("h2",{attrs:{id:"profile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#profile"}},[e._v("#")]),e._v(" Profile")]),e._v(" "),a("ul",[a("li",[e._v("位于 "),a("code",[e._v("cargo.toml")]),e._v(" 配置文件中")]),e._v(" "),a("li",[e._v("Cargo 有两个只要的 Profile ，分别是 "),a("code",[e._v("dev")]),e._v(" 和 "),a("code",[e._v("release")])]),e._v(" "),a("li",[a("code",[e._v("dev")]),e._v(" 配置为 "),a("code",[e._v("[profile.dev]")]),e._v(" ，"),a("code",[e._v("release")]),e._v(" 配置为 "),a("code",[e._v("[profile.release]")])]),e._v(" "),a("li",[e._v("各个 Profile 之间是相互独立的，用来控制编译时的行为")]),e._v(" "),a("li",[a("code",[e._v("dev")]),e._v(" 用于 "),a("code",[e._v("cargo build")]),e._v(" ，"),a("code",[e._v("release")]),e._v(" 用于 "),a("code",[e._v("cargo build --release")])])]),e._v(" "),a("h2",{attrs:{id:"默认配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#默认配置"}},[e._v("#")]),e._v(" 默认配置")]),e._v(" "),a("p",[e._v("Cargo 编译时的默认行为等同于下面的配置：")]),e._v(" "),a("blockquote",[a("p",[e._v("Cargo.toml")])]),e._v(" "),a("div",{staticClass:"language-toml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[e._v("profile.dev")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[e._v("opt-level")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[e._v("profile.release")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[e._v("opt-level")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br")])]),a("p",[e._v("关于 "),a("code",[e._v("opt-level")]),e._v(" ：")]),e._v(" "),a("ul",[a("li",[e._v("设置 Rust 编译时的代码优化级别")]),e._v(" "),a("li",[e._v("范围是 0 - 3 ，数字越大，优化级别越高")]),e._v(" "),a("li",[e._v("优化级别越高，编译时耗时越长，编译成果运行效率越高")]),e._v(" "),a("li",[e._v("因此，默认在 "),a("code",[e._v("dev")]),e._v(" 即开发阶段时，配置为 0 ，因为开发阶段编译代码比较频繁；而在 "),a("code",[e._v("release")]),e._v(" 即发布阶段时，配置为 3 ，因为发布时追求的是运行效率")])]),e._v(" "),a("p",[e._v("对应的，默认配置时编译提示如下：")]),e._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ cargo build\n    Finished dev [unoptimized + debuginfo] target(s) in 0.0 secs\n$ cargo build --release\n    Finished release [optimized] target(s) in 0.0 secs\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("h2",{attrs:{id:"修改配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改配置"}},[e._v("#")]),e._v(" 修改配置")]),e._v(" "),a("p",[e._v("例如，修改配置如下：")]),e._v(" "),a("div",{staticClass:"language-toml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[e._v("profile.dev")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[e._v("opt-level")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("则对 Carogo 的影响是：")]),e._v(" "),a("ul",[a("li",[e._v("在 "),a("code",[e._v("cargo build")]),e._v(" 时，使用 "),a("code",[e._v("opt-level = 1")]),e._v(" ，而不是默认的 "),a("code",[e._v("0")])]),e._v(" "),a("li",[e._v("在 "),a("code",[e._v("cargo build --release")]),e._v(" 时，仍然使用默认的 "),a("code",[e._v("3")]),e._v(" ，因为并没有对 "),a("code",[e._v("profile.release")]),e._v(" 进行过配置")])]),e._v(" "),a("h2",{attrs:{id:"其它配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其它配置"}},[e._v("#")]),e._v(" 其它配置")]),e._v(" "),a("p",[e._v("参考 "),a("a",{attrs:{href:"https://doc.rust-lang.org/cargo/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Cargo's documentation"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=r.exports}}]);